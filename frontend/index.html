<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Repack Browser</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deepest: #0a0a0a; --bg-deep: #0f0f0f; --bg-card: #141414; --bg-card-hover: #1a1a1a;
            --bg-surface: #1c1c1c; --bg-input: #121212; --border: #2a2a2a; --border-hover: #3a3a3a;
            --accent: #3b82f6; --accent-glow: rgba(59,130,246,0.15); --accent-bright: #60a5fa; --accent-hover: #2563eb;
            --text: #e2e8f0; --text-muted: #94a3b8; --text-dim: #64748b;
            --gold: #f59e0b; --gold-dim: rgba(245,158,11,0.12); --yellow-bg: rgba(245,158,11,0.15);
            --genre-bg: rgba(59,130,246,0.10); --genre-text: #93c5fd;
            --green: #22c55e; --green-dim: rgba(34,197,94,0.12);
            --red: #ef4444; --red-dim: rgba(239,68,68,0.12);
            --purple: #8b5cf6; --purple-dim: rgba(139,92,246,0.12);
        }
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Outfit',sans-serif;background:var(--bg-deepest);color:var(--text);min-height:100vh}

        .hidden{display:none!important}

        /* ‚îÄ‚îÄ Featured Carousel Grid ‚îÄ‚îÄ */
        .featured-carousel{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:2rem}
        .carousel-tabs{display:flex;gap:0;border-bottom:1px solid var(--border);background:var(--bg-surface);padding:0.5rem}
        .carousel-tab{padding:0.5rem 1rem;border-radius:8px;background:transparent;border:none;color:var(--text-muted);font-family:inherit;font-size:0.825rem;font-weight:600;cursor:pointer;transition:all 0.2s}
        .carousel-tab:hover{background:var(--bg-card);color:var(--text)}
        .carousel-tab.active{background:var(--accent);color:#fff}
        .carousel-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:0.875rem;padding:1rem}
        .carousel-card{position:relative;aspect-ratio:16/9;background:var(--bg-deep);border-radius:10px;overflow:hidden;cursor:pointer;transition:all 0.2s;border:1px solid var(--border)}
        .carousel-card:hover{border-color:var(--accent);transform:translateY(-4px);box-shadow:0 8px 24px rgba(0,0,0,0.4)}
        .carousel-card-thumb{position:relative;width:100%;height:100%}
        .carousel-card-thumb img{width:100%;height:100%;object-fit:cover;display:block}
        .carousel-card-rank{position:absolute;top:0.5rem;left:0.5rem;background:rgba(0,0,0,0.75);backdrop-filter:blur(8px);color:#fff;font-size:0.75rem;font-weight:700;padding:0.25rem 0.5rem;border-radius:6px;font-family:'JetBrains Mono',monospace}
        .carousel-card-body{position:absolute;bottom:0;left:0;right:0;padding:0.875rem;background:linear-gradient(180deg,transparent 0%,rgba(0,0,0,0.9) 100%);color:#fff}
        .carousel-card-title{font-size:0.825rem;font-weight:600;line-height:1.3;margin-bottom:0.25rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
        .carousel-card-size{font-size:0.7rem;color:rgba(255,255,255,0.7);font-family:'JetBrains Mono',monospace}
        @media(max-width:1024px){.carousel-grid{grid-template-columns:repeat(2,1fr)}}
        @media(max-width:768px){.carousel-grid{grid-template-columns:1fr}}

        /* ‚îÄ‚îÄ Right Sidebar ‚îÄ‚îÄ */
        .right-sidebar{position:fixed;right:0;top:60px;bottom:0;width:280px;background:var(--bg-card);border-left:1px solid var(--border);padding:1.25rem;overflow-y:auto;z-index:50;transform:translateX(100%);transition:transform 0.3s cubic-bezier(0.4,0,0.2,1)}
        .right-sidebar.open{transform:translateX(0)}
        .sidebar-toggle{position:fixed;right:1rem;bottom:1rem;width:48px;height:48px;border-radius:50%;background:var(--accent);color:#fff;border:none;cursor:pointer;box-shadow:0 4px 12px rgba(59,130,246,0.4);display:flex;align-items:center;justify-content:center;font-size:1.25rem;z-index:60;transition:all 0.2s}
        .sidebar-toggle:hover{background:var(--accent-hover);transform:scale(1.1)}
        .sidebar-section{margin-bottom:1.5rem}
        .sidebar-title{font-size:0.75rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-dim);margin-bottom:0.5rem}
        .sidebar-search{width:100%;background:var(--bg-input);border:1px solid var(--border);border-radius:8px;padding:0.4rem 0.6rem;color:var(--text);font-family:inherit;font-size:0.75rem;outline:none;margin-bottom:0.5rem}
        .sidebar-search:focus{border-color:var(--accent)}
        .filter-list{display:flex;flex-direction:column;gap:0.25rem;max-height:300px;overflow-y:auto}
        .filter-item{display:flex;justify-content:space-between;align-items:center;padding:0.4rem 0.6rem;border-radius:6px;cursor:pointer;transition:background 0.15s;font-size:0.8rem}
        .filter-item:hover{background:var(--bg-surface)}
        .filter-item.active{background:var(--accent-glow);color:var(--accent-bright)}
        .filter-count{font-family:'JetBrains Mono',monospace;font-size:0.7rem;color:var(--text-dim)}

        /* ‚îÄ‚îÄ Notification Panel ‚îÄ‚îÄ */
        .notification-panel{position:fixed;top:60px;right:1rem;width:360px;max-height:480px;background:var(--bg-card);border:1px solid var(--border);border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.5);z-index:150;transform:translateY(-10px);opacity:0;transition:all 0.2s;pointer-events:none}
        .notification-panel:not(.hidden){transform:translateY(0);opacity:1;pointer-events:auto}
        .notification-header{display:flex;justify-content:space-between;align-items:center;padding:1rem;border-bottom:1px solid var(--border)}
        .notification-list{max-height:400px;overflow-y:auto}
        .notification-item{padding:0.875rem 1rem;border-bottom:1px solid var(--border);cursor:pointer;transition:background 0.15s;position:relative}
        .notification-item:hover{background:var(--bg-surface)}
        .notification-item.unread{background:var(--accent-glow)}
        .notification-item.unread::before{content:'';position:absolute;left:0.5rem;top:50%;transform:translateY(-50%);width:6px;height:6px;border-radius:50%;background:var(--accent)}
        .notification-title{font-size:0.8rem;font-weight:600;margin-bottom:0.25rem;padding-left:1rem}
        .notification-item.unread .notification-title{color:var(--accent-bright)}
        .notification-message{font-size:0.75rem;color:var(--text-muted);margin-bottom:0.25rem;padding-left:1rem}
        .notification-time{font-size:0.65rem;color:var(--text-dim);padding-left:1rem}

        /* ‚îÄ‚îÄ Top Bar ‚îÄ‚îÄ */
        .topbar{position:sticky;top:0;z-index:100;background:rgba(12,16,24,0.82);backdrop-filter:blur(24px) saturate(1.2);-webkit-backdrop-filter:blur(24px) saturate(1.2);border-bottom:1px solid var(--border);padding:0 1.75rem;height:60px;display:flex;align-items:center;gap:0.5rem}
        .topbar-logo{display:flex;align-items:center;gap:0.625rem;margin-right:1.5rem;flex-shrink:0}
        .source-toggle{display:flex;gap:0.25rem;background:var(--bg-surface);border-radius:8px;padding:0.25rem}
        .source-toggle-btn{background:transparent;color:var(--text-muted);border:none;padding:0.4rem 0.875rem;border-radius:6px;font-family:inherit;font-size:0.825rem;font-weight:600;cursor:pointer;transition:all 0.2s;white-space:nowrap}
        .source-toggle-btn:hover{background:rgba(59,130,246,0.1);color:var(--text)}
        .source-toggle-btn.active{background:var(--accent);color:#fff}
        .topbar-nav{display:flex;gap:0.25rem}
        .nav-btn{background:transparent;color:var(--text-muted);border:none;padding:0.4rem 0.875rem;border-radius:8px;font-family:inherit;font-size:0.825rem;font-weight:500;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;gap:0.4rem;position:relative}
        .nav-btn:hover{background:var(--bg-surface);color:var(--text)}
        .nav-btn.active{background:var(--accent);color:#fff}
        .topbar-spacer{flex:1}
        .topbar-actions{display:flex;align-items:center;gap:0.375rem}
        .icon-btn{padding:0.4rem 0.75rem;height:38px;border-radius:9px;background:var(--bg-surface);border:1px solid var(--border);color:var(--text-muted);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:0.775rem;font-weight:500;font-family:inherit;transition:all 0.2s}
        .icon-btn:hover{border-color:var(--border-hover);color:var(--text);background:var(--bg-card)}
        .download-badge{position:absolute;top:-5px;right:-5px;background:var(--red);color:#fff;border-radius:50%;min-width:18px;height:18px;font-size:10px;display:flex;align-items:center;justify-content:center;font-weight:700;font-family:'JetBrains Mono',monospace}
        .user-info{display:flex;align-items:center;gap:0.5rem;padding:0.4rem 0.875rem;height:38px;border-radius:9px;background:var(--bg-surface);border:1px solid var(--border);color:var(--text);font-size:0.775rem;font-weight:500}
        .user-info-name{color:var(--accent-bright)}
        .user-info-admin{background:var(--gold);color:#000;padding:0.125rem 0.375rem;border-radius:4px;font-size:0.65rem;font-weight:700;margin-left:0.25rem}
        .logout-btn{padding:0.4rem 0.75rem;height:38px;border-radius:9px;background:transparent;border:1px solid var(--border);color:var(--text-muted);cursor:pointer;font-size:0.775rem;font-weight:500;font-family:inherit;transition:all 0.2s}
        .logout-btn:hover{border-color:var(--red);color:var(--red);background:var(--red-dim)}

        /* ‚îÄ‚îÄ Scrape Progress ‚îÄ‚îÄ */
        .scrape-progress{margin:0.75rem 1.75rem 0;background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1rem 1.25rem}
        .scrape-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:0.5rem}
        .scrape-header-left{display:flex;align-items:center;gap:0.5rem;font-size:0.8rem;font-weight:600}
        .scrape-pct{font-size:0.8rem;color:var(--text-dim);font-family:'JetBrains Mono',monospace}
        .progress-track{height:6px;background:var(--bg-deep);border-radius:999px;overflow:hidden;margin-bottom:0.5rem}
        .progress-fill{height:100%;border-radius:999px;background:var(--green);transition:width 0.5s ease,background 0.3s}
        .progress-fill.enriching{background:var(--purple)} .progress-fill.saving{background:var(--gold)}
        .scrape-detail{display:flex;justify-content:space-between;font-size:0.7rem;color:var(--text-dim);margin-bottom:0.5rem}
        .scrape-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:0.5rem}
        .scrape-stat{background:var(--bg-surface);border-radius:8px;padding:0.4rem 0.5rem;text-align:center;font-size:0.7rem;color:var(--text-dim)}
        .scrape-stat strong{display:block;font-size:0.85rem;color:var(--text);font-family:'JetBrains Mono',monospace}

        /* ‚îÄ‚îÄ Error Banner ‚îÄ‚îÄ */
        .error-banner{margin:0.75rem 1.75rem 0;background:var(--red-dim);border:1px solid rgba(239,68,68,0.25);border-radius:10px;padding:0.75rem 1rem;display:flex;justify-content:space-between;align-items:center;font-size:0.85rem;color:#fca5a5}
        .error-banner button{background:none;border:none;color:#fca5a5;cursor:pointer;font-size:1.2rem;padding:0 0.25rem}

        /* ‚îÄ‚îÄ Content ‚îÄ‚îÄ */
        .content{max-width:1440px;margin:0 auto;padding:1.25rem 1.75rem;position:relative;z-index:1}

        /* ‚îÄ‚îÄ Filter Bar ‚îÄ‚îÄ */
        .filter-bar{display:flex;gap:0.625rem;margin-bottom:1rem;align-items:center;flex-wrap:wrap}
        .filter-input{background:var(--bg-input);border:1px solid var(--border);border-radius:10px;padding:0.575rem 0.875rem;color:var(--text);font-family:inherit;font-size:0.825rem;outline:none;transition:all 0.2s;min-width:220px;flex:1}
        .filter-input:focus{border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-glow)}
        .filter-input::placeholder{color:var(--text-dim)}
        .filter-select{background:var(--bg-input);border:1px solid var(--border);border-radius:10px;padding:0.575rem 2rem 0.575rem 0.875rem;color:var(--text);font-family:inherit;font-size:0.825rem;outline:none;cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%2394a3b8' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 0.7rem center;transition:border-color 0.2s}
        .filter-select:focus{border-color:var(--accent)}
        .filter-spacer{flex:1;min-width:0}
        .pill-btn{padding:0.5rem 0.9rem;border-radius:999px;border:1px solid var(--border);background:var(--bg-card);color:var(--text-muted);font-family:inherit;font-size:0.775rem;font-weight:500;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;gap:0.35rem;flex-shrink:0}
        .pill-btn:hover{border-color:var(--accent);color:var(--accent-bright);background:var(--accent-glow)}
        .pill-btn.bg-yellow-700{background:var(--yellow-bg)!important;border-color:var(--gold)!important;color:var(--gold)!important}
        .pill-btn-clear{width:34px;height:34px;border-radius:999px;border:1px solid var(--border);background:var(--bg-card);color:var(--text-dim);font-size:0.9rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s;flex-shrink:0}
        .pill-btn-clear:hover{border-color:var(--red);color:var(--red);background:var(--red-dim)}
        .stats-text{font-size:0.775rem;color:var(--text-dim);margin-bottom:0.75rem}

        /* ‚îÄ‚îÄ Game Grid ‚îÄ‚îÄ */
        .game-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(210px,1fr));gap:0.875rem;margin-bottom:1.5rem}
        @media(min-width:1280px){.game-grid{grid-template-columns:repeat(5,1fr)}}
        .game-card{background:var(--bg-card);border-radius:12px;overflow:hidden;border:1px solid var(--border);cursor:pointer;transition:all 0.25s cubic-bezier(0.4,0,0.2,1);position:relative}
        .game-card:hover{border-color:var(--accent);transform:translateY(-4px);box-shadow:0 12px 40px rgba(0,0,0,0.4),0 0 0 1px var(--accent),0 0 30px var(--accent-glow)}
        .game-card.favorited{border-color:rgba(245,158,11,0.35)}
        .game-thumb{aspect-ratio:16/9;background:var(--bg-deep);overflow:hidden;position:relative}
        .game-thumb img{width:100%;height:100%;object-fit:cover;display:block;transition:transform 0.4s cubic-bezier(0.4,0,0.2,1)}
        .game-card:hover .game-thumb img{transform:scale(1.05)}
        .game-thumb::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent 50%,rgba(0,0,0,0.6) 100%);pointer-events:none}
        .game-thumb-fallback{display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#1a2236,#0c1018);font-size:2.5rem;color:var(--text-dim);opacity:0.35}
        .fav-star{position:absolute;top:6px;right:6px;width:30px;height:30px;border-radius:8px;background:rgba(0,0,0,0.45);backdrop-filter:blur(4px);border:none;color:var(--text-muted);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:0.85rem;z-index:3;transition:all 0.2s}
        .fav-star:hover{background:rgba(0,0,0,0.65);transform:scale(1.1)}
        .source-badge{position:absolute;top:6px;left:6px;padding:0.25rem 0.5rem;border-radius:6px;font-size:0.65rem;font-weight:700;text-transform:uppercase;letter-spacing:0.02em;z-index:3;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)}
        .source-badge.fitgirl{background:rgba(139,92,246,0.85);color:white}
        .source-badge.steamrip{background:rgba(59,130,246,0.85);color:white}
        .card-body{padding:0.75rem}
        .card-header{display:flex;justify-content:space-between;align-items:flex-start;gap:0.375rem;margin-bottom:0.25rem}
        .card-title{font-size:0.825rem;font-weight:600;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
        .card-year{font-size:0.65rem;font-weight:500;color:var(--text-dim);font-family:'JetBrains Mono',monospace;flex-shrink:0;margin-top:2px}
        .card-company{font-size:0.7rem;color:var(--text-dim);margin-bottom:0.375rem}
        .card-genres{display:flex;flex-wrap:wrap;gap:0.2rem;margin-bottom:0.375rem}
        .genre-tag{font-size:0.625rem;font-weight:500;padding:0.125rem 0.45rem;border-radius:999px;background:var(--genre-bg);color:var(--genre-text);cursor:pointer;transition:background 0.15s}
        .genre-tag:hover{background:rgba(59,130,246,0.22)}
        .card-size{font-size:0.7rem;color:var(--text-muted);font-family:'JetBrains Mono',monospace}
        .card-size .arrow{color:var(--text-dim);margin:0 0.15rem}

        /* ‚îÄ‚îÄ Pagination ‚îÄ‚îÄ */
        .pagination{display:flex;justify-content:center;gap:0.3rem;flex-wrap:wrap;padding-bottom:2rem}
        .page-btn{min-width:38px;height:38px;border-radius:9px;border:1px solid var(--border);background:var(--bg-card);color:var(--text-muted);font-family:inherit;font-size:0.8rem;font-weight:500;cursor:pointer;transition:all 0.15s;display:flex;align-items:center;justify-content:center;padding:0 0.5rem}
        .page-btn:hover{border-color:var(--accent);color:var(--text)}
        .page-btn.active{background:var(--accent);border-color:var(--accent);color:#fff}

        /* ‚îÄ‚îÄ Downloads ‚îÄ‚îÄ */
        .downloads-header{display:flex;justify-content:space-between;align-items:center;gap:1rem;margin-bottom:1rem}
        .downloads-header h2{font-size:1.35rem;font-weight:700;margin-bottom:0.25rem}
        .downloads-header p{font-size:0.8rem;color:var(--text-dim);margin-bottom:0}

        /* ‚îÄ‚îÄ Modals ‚îÄ‚îÄ */
        .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.75);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:200}
        .modal-box{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;padding:1.5rem;width:100%;max-height:90vh;overflow-y:auto;margin:0 1rem}
        .modal-box.sm{max-width:420px} .modal-box.md{max-width:520px} .modal-box.lg{max-width:680px}
        .modal-title{font-size:1.15rem;font-weight:700;margin-bottom:1rem}
        .modal-actions{display:flex;gap:0.5rem;margin-top:1rem}

        /* ‚îÄ‚îÄ Buttons ‚îÄ‚îÄ */
        .btn{padding:0.5rem 1rem;border-radius:9px;border:1px solid transparent;font-family:inherit;font-size:0.825rem;font-weight:600;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:0.375rem}
        .btn-primary{background:var(--accent);color:#fff;flex:1} .btn-primary:hover{background:var(--accent-hover)}
        .btn-secondary{background:var(--bg-surface);border-color:var(--border);color:var(--text-muted);flex:1} .btn-secondary:hover{border-color:var(--border-hover);color:var(--text);background:var(--bg-card-hover)}
        .btn-gold{background:var(--yellow-bg);border-color:var(--gold);color:var(--gold)} .btn-gold:hover{background:rgba(245,158,11,0.25)}
        .btn-ghost{background:transparent;border-color:var(--border);color:var(--text-muted)} .btn-ghost:hover{border-color:var(--border-hover);color:var(--text)}

        /* ‚îÄ‚îÄ Forms ‚îÄ‚îÄ */
        .form-label{display:block;font-size:0.825rem;font-weight:600;margin-bottom:0.25rem}
        .form-label .hint{font-weight:400;color:var(--text-dim)}
        .form-help{font-size:0.7rem;color:var(--text-dim);margin-bottom:0.375rem}
        .form-help a{color:var(--accent-bright);text-decoration:none} .form-help a:hover{text-decoration:underline}
        .form-input{width:100%;background:var(--bg-input);border:1px solid var(--border);border-radius:9px;padding:0.5rem 0.75rem;color:var(--text);font-family:inherit;font-size:0.825rem;outline:none;transition:border-color 0.2s}
        .form-input:focus{border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-glow)}
        .form-row{display:flex;gap:0.5rem;align-items:center}
        .form-status{font-size:0.7rem;color:var(--text-dim);margin-top:0.25rem}
        .form-group + .form-group{margin-top:1.25rem}
        .settings-tab{padding:0.5rem 1rem;border-radius:8px 8px 0 0;background:transparent;border:none;color:var(--text-muted);font-family:inherit;font-size:0.8rem;font-weight:600;cursor:pointer;transition:all 0.2s;border-bottom:2px solid transparent}
        .settings-tab:hover{background:var(--bg-surface);color:var(--text)}
        .settings-tab.active{background:transparent;color:var(--accent);border-bottom-color:var(--accent)}
        .settings-panel{display:block}
        .settings-panel.hidden{display:none}
        .checkbox-group{display:flex;flex-direction:column;gap:0.5rem}

        /* ‚îÄ‚îÄ Utilities ‚îÄ‚îÄ */
        .spinner{border:3px solid rgba(255,255,255,0.08);border-top-color:var(--accent);border-radius:50%;width:24px;height:24px;animation:spin 0.7s linear infinite;display:inline-block;vertical-align:middle}
        @keyframes spin{to{transform:rotate(360deg)}}
        .loading-state{display:flex;justify-content:center;align-items:center;padding:4rem 0}
        .empty-state{text-align:center;padding:4rem 2rem;max-width:420px;margin:0 auto}
        .empty-icon{font-size:4rem;margin-bottom:1rem;opacity:0.4}
        .empty-title{font-size:1.35rem;font-weight:700;color:var(--text);margin-bottom:0.5rem}
        .empty-subtitle{font-size:0.9rem;color:var(--text-muted);line-height:1.5;margin-bottom:1.5rem;max-width:360px;margin-left:auto;margin-right:auto}
        .empty-action{margin-top:1rem}
        .toast{position:fixed;bottom:1.25rem;right:1.25rem;background:var(--bg-card);border:1px solid var(--border);padding:0.75rem 1.25rem;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.4);z-index:300;max-width:360px;font-size:0.85rem}
        .toast-success{border-left:3px solid var(--green)} .toast-error{border-left:3px solid var(--red)} .toast-info{border-left:3px solid var(--accent)}
        .screenshot-thumb{border:2px solid transparent}
        .screenshot-thumb.border-blue-500{border-color:var(--accent)!important}
        .screenshot-thumb.border-transparent{border-color:transparent!important}

        /* ‚îÄ‚îÄ Library View ‚îÄ‚îÄ */
        .library-tab:hover{background:rgba(59,130,246,0.1);color:var(--text)}
        .library-tab.active{background:var(--accent);color:#fff}

        /* ‚îÄ‚îÄ View Toggle ‚îÄ‚îÄ */
        .view-toggle{display:flex;gap:0.25rem;background:var(--bg-surface);border-radius:8px;padding:0.25rem;flex-shrink:0}
        .view-toggle-btn{background:transparent;color:var(--text-muted);border:none;padding:0.4rem 0.75rem;border-radius:6px;font-family:inherit;font-size:0.825rem;font-weight:600;cursor:pointer;transition:all 0.2s;white-space:nowrap}
        .view-toggle-btn:hover{background:rgba(59,130,246,0.1);color:var(--text)}
        .view-toggle-btn.active{background:var(--accent);color:#fff}

        /* ‚îÄ‚îÄ List View ‚îÄ‚îÄ */
        .view-mode-list .game-grid{display:flex;flex-direction:column;gap:0.875rem}
        .view-mode-list .game-card{display:flex;flex-direction:row;border-radius:12px;overflow:visible;max-width:100%}
        .view-mode-list .game-thumb{aspect-ratio:16/9;width:140px;flex-shrink:0;border-radius:10px 0 0 10px}
        .view-mode-list .game-thumb .fav-star{display:none}
        .view-mode-list .card-body{flex:1;display:flex;align-items:center;gap:1rem;padding:1rem}
        .view-mode-list .card-info{flex:1;min-width:0}
        .view-mode-list .card-header{margin-bottom:0.25rem}
        .view-mode-list .card-title{font-size:0.925rem;-webkit-line-clamp:1}
        .view-mode-list .card-genres{margin-bottom:0}
        .view-mode-list .card-actions{display:flex!important;align-items:center;gap:0.5rem;flex-shrink:0}
        .view-mode-list .card-actions .fav-star{position:static;width:36px;height:36px;border-radius:10px}
        .view-mode-list .source-badge{position:absolute;top:6px;left:6px}
        .view-mode-list .game-card:hover{transform:translateX(4px)}

        /* ‚îÄ‚îÄ Left Sidebar ‚îÄ‚îÄ */
        .left-sidebar{position:fixed;left:0;top:0;bottom:0;width:245px;background:var(--bg-card);border-right:1px solid var(--border);display:flex;flex-direction:column;z-index:100;padding:1rem 0;overflow-y:auto}
        .sidebar-header{padding:0 1.25rem 1.25rem;border-bottom:1px solid var(--border)}
        .sidebar-logo{font-size:0.9rem;font-weight:700;color:var(--text);display:flex;align-items:center;gap:0.5rem}
        .sidebar-nav{display:flex;flex-direction:column;padding:1rem 0.75rem;gap:0.25rem;flex:1}
        .sidebar-nav-item{display:flex;align-items:center;gap:0.75rem;padding:0.625rem 0.875rem;border-radius:10px;background:transparent;border:none;color:var(--text-muted);font-family:inherit;font-size:0.85rem;font-weight:500;cursor:pointer;transition:all 0.2s;text-align:left;width:100%}
        .sidebar-nav-item:hover{background:var(--bg-surface);color:var(--text)}
        .sidebar-nav-item.active{background:var(--accent);color:#fff}
        .sidebar-nav-item .nav-icon{font-size:1.1rem;flex-shrink:0}
        .sidebar-nav-item .nav-label{flex:1}
        .sidebar-section{padding:0 1.25rem;margin-top:auto;border-top:1px solid var(--border);padding-top:1rem}
        .sidebar-section-title{font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-dim);margin-bottom:0.75rem}
        .source-toggle-vertical{display:flex;flex-direction:column;gap:0.25rem}
        .source-toggle-vertical .source-toggle-btn{background:transparent;color:var(--text-muted);border:1px solid var(--border);padding:0.5rem 0.75rem;border-radius:8px;font-family:inherit;font-size:0.825rem;font-weight:600;cursor:pointer;transition:all 0.2s;text-align:center}
        .source-toggle-vertical .source-toggle-btn:hover{background:rgba(59,130,246,0.1);color:var(--text);border-color:var(--border-hover)}
        .source-toggle-vertical .source-toggle-btn.active{background:var(--accent);color:#fff;border-color:var(--accent)}

        /* Adjust content and topbar for sidebar */
        .topbar,.content,.scrape-progress,.error-banner{margin-left:245px}
        .topbar .source-toggle{display:none} /* Hide topbar source toggle */
        .topbar-nav{display:none} /* Hide topbar nav buttons */

        @media(max-width:768px){
            .left-sidebar{width:60px}
            .sidebar-logo,.nav-label,.sidebar-section-title{display:none}
            .sidebar-nav{padding:1rem 0.5rem}
            .sidebar-nav-item{justify-content:center;padding:0.75rem}
            .sidebar-section{padding:0.5rem}
            .source-toggle-vertical .source-toggle-btn{padding:0.625rem;font-size:0.75rem}
            .topbar,.content,.scrape-progress,.error-banner{margin-left:60px}
            .topbar{padding:0 1rem;gap:0.25rem} .content{padding:1rem}
            .filter-bar{gap:0.5rem} .filter-input{min-width:100%} .game-grid{grid-template-columns:repeat(2,1fr);gap:0.625rem}
            .scrape-stats{grid-template-columns:repeat(2,1fr)} .topbar-logo-text{display:none}
            .right-sidebar{width:100%;top:60px} .sidebar-toggle{bottom:4rem}
        }
    </style>
</head>
<body>
    <!-- Left Sidebar -->
    <aside class="left-sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">üìö Repack Browser</div>
        </div>
        <nav class="sidebar-nav">
            <button id="sidebarHome" onclick="showView('home')" class="sidebar-nav-item">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">Home</span>
            </button>
            <button id="sidebarGames" onclick="showView('games')" class="sidebar-nav-item active">
                <span class="nav-icon">üìö</span>
                <span class="nav-label">Catalogue</span>
            </button>
            <button id="sidebarLibrary" onclick="showView('library')" class="sidebar-nav-item">
                <span class="nav-icon">‚≠ê</span>
                <span class="nav-label">Library</span>
            </button>
            <button id="sidebarDownloads" onclick="showView('downloads')" class="sidebar-nav-item">
                <span class="nav-icon">‚¨áÔ∏è</span>
                <span class="nav-label">Downloads</span>
                <span id="sidebarDownloadBadge" class="download-badge hidden" style="position:static;margin-left:auto;">0</span>
            </button>
            <button id="sidebarClients" onclick="showView('clients')" class="sidebar-nav-item">
                <span class="nav-icon">üíª</span>
                <span class="nav-label">Clients</span>
            </button>
            <button id="sidebarSystemHealth" onclick="showView('systemHealth')" class="sidebar-nav-item">
                <span class="nav-icon">üè•</span>
                <span class="nav-label">Health</span>
            </button>
            <button id="sidebarSettings" onclick="showSettingsModal()" class="sidebar-nav-item">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-label">Settings</span>
            </button>
        </nav>
        <div class="sidebar-section">
            <div class="sidebar-section-title">SOURCES</div>
            <div class="source-toggle-vertical">
                <button onclick="setSource('all')" class="source-toggle-btn active" data-source="all">All</button>
                <button onclick="setSource('fitgirl')" class="source-toggle-btn" data-source="fitgirl">FitGirl</button>
                <button onclick="setSource('steamrip')" class="source-toggle-btn" data-source="steamrip">SteamRIP</button>
            </div>
        </div>
    </aside>

    <header class="topbar">
        <div class="topbar-spacer"></div>
        <div class="topbar-actions">
            <div id="userInfo" class="user-info hidden">
                <span id="userName" class="user-info-name"></span>
                <span id="userAdmin" class="user-info-admin hidden">ADMIN</span>
            </div>
            <div style="position:relative;">
                <button id="notificationBtn" onclick="toggleNotificationPanel()" class="icon-btn" title="Notifications">üîî</button>
                <span id="notificationBadge" class="download-badge hidden" style="right:-5px;">0</span>
            </div>
            <button onclick="showUploadModal()" class="icon-btn" title="Upload CSV">CSV</button>
            <button id="scrapeBtn" onclick="rescrape()" class="icon-btn" title="Re-scrape site">Scrape</button>
            <button onclick="showSettingsModal()" class="icon-btn" title="Settings">Settings</button>
            <button id="logoutBtn" onclick="handleLogout()" class="logout-btn hidden" title="Logout">Logout</button>
        </div>
    </header>

    <!-- Notification Panel -->
    <div id="notificationPanel" class="notification-panel hidden">
        <div class="notification-header">
            <h3 style="font-size:0.9rem;font-weight:700;">Notifications</h3>
            <button onclick="markAllNotificationsRead()" class="btn btn-ghost" style="padding:0.25rem 0.5rem;font-size:0.75rem;">Mark all read</button>
        </div>
        <div id="notificationList" class="notification-list">
            <div style="text-align:center;padding:2rem;color:var(--text-dim);font-size:0.85rem;">Loading...</div>
        </div>
    </div>

    <div id="scrapeProgressContainer" class="hidden scrape-progress">
        <div class="scrape-header">
            <div class="scrape-header-left"><span class="spinner" style="width:14px;height:14px;border-width:2px;"></span> Scraping in progress</div>
            <span id="scrapeProgressPct" class="scrape-pct">0%</span>
        </div>
        <div class="progress-track"><div id="scrapeProgressBar" class="progress-fill" style="width:0%"></div></div>
        <div class="scrape-detail"><span id="scrapeProgressMessage">Starting...</span><span id="scrapeProgressStats"></span></div>
        <div id="scrapeMetadataStats" class="hidden scrape-stats">
            <div class="scrape-stat"><strong id="statGames">0</strong> games</div>
            <div class="scrape-stat"><strong id="statImages">0</strong> images</div>
            <div class="scrape-stat"><strong id="statGenres">0</strong> genres</div>
            <div class="scrape-stat"><strong id="statCompanies">0</strong> companies</div>
        </div>
    </div>

    <div id="errorBanner" class="hidden error-banner">
        <span id="errorText">An error occurred.</span>
        <button onclick="document.getElementById('errorBanner').classList.add('hidden')">&times;</button>
    </div>

    <main class="content">
        <div id="homeView" class="hidden">
            <!-- Featured Games Carousel -->
            <div class="featured-carousel">
                <div class="carousel-tabs">
                    <button class="carousel-tab active" data-category="hot" onclick="loadFeaturedCategory('hot')">üî• Hot now</button>
                    <button class="carousel-tab" data-category="top_week" onclick="loadFeaturedCategory('top_week')">üìà Top of week</button>
                    <button class="carousel-tab" data-category="to_beat" onclick="loadFeaturedCategory('to_beat')">‚ö° Games to beat</button>
                    <button class="carousel-tab" data-category="surprise" onclick="loadFeaturedCategory('surprise')">üé≤ Surprise me</button>
                </div>
                <div id="carouselGrid" class="carousel-grid">
                    <div style="grid-column:1/-1;display:flex;align-items:center;justify-content:center;padding:4rem;color:var(--text-dim);">
                        <div class="spinner" style="width:48px;height:48px;border-width:4px;"></div>
                    </div>
                </div>
            </div>

            <div style="max-width:900px;margin:0 auto;">
                <div style="text-align:center;margin-bottom:2.5rem;">
                    <h1 style="font-size:2.5rem;font-weight:800;margin-bottom:0.5rem;background:linear-gradient(135deg,var(--accent),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;">Multi-Source Game Browser</h1>
                    <p style="font-size:1.1rem;color:var(--text-muted);">Browse and download games from multiple repack sources</p>
                </div>

                <div style="display:grid;gap:1.5rem;">
                    <!-- Quick Start -->
                    <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1.5rem;">
                        <h2 style="font-size:1.35rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem;">üöÄ Quick Start</h2>
                        <ol style="margin-left:1.5rem;line-height:1.8;color:var(--text-muted);">
                            <li><strong style="color:var(--text);">Set up API keys</strong> - Click Settings and add your Real-Debrid and RAWG API keys</li>
                            <li><strong style="color:var(--text);">Scrape games</strong> - Click the Scrape button to fetch games from all sources</li>
                            <li><strong style="color:var(--text);">Browse library</strong> - Use the source tabs to filter between different repack sources</li>
                            <li><strong style="color:var(--text);">Download games</strong> - Click a game ‚Üí Get Links ‚Üí Download files</li>
                        </ol>
                    </div>

                    <!-- Features -->
                    <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1.5rem;">
                        <h2 style="font-size:1.35rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem;">‚ú® Features</h2>
                        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem;">
                            <div>
                                <div style="font-weight:600;color:var(--text);margin-bottom:0.25rem;">üéÆ Multi-Source Support</div>
                                <div style="font-size:0.875rem;color:var(--text-muted);">Browse games from multiple repack sources in one place</div>
                            </div>
                            <div>
                                <div style="font-weight:600;color:var(--text);margin-bottom:0.25rem;">‚ö° Real-Debrid Integration</div>
                                <div style="font-size:0.875rem;color:var(--text-muted);">Direct downloads via Real-Debrid (magnets + DDL)</div>
                            </div>
                            <div>
                                <div style="font-weight:600;color:var(--text);margin-bottom:0.25rem;">üîç Advanced Search</div>
                                <div style="font-size:0.875rem;color:var(--text-muted);">Search, filter by genre, sort by size/date/title</div>
                            </div>
                            <div>
                                <div style="font-weight:600;color:var(--text);margin-bottom:0.25rem;">üì¶ Auto-Extract</div>
                                <div style="font-size:0.875rem;color:var(--text-muted);">Automatically extracts archives after download</div>
                            </div>
                            <div>
                                <div style="font-weight:600;color:var(--text);margin-bottom:0.25rem;">‚úÖ MD5 Validation</div>
                                <div style="font-size:0.875rem;color:var(--text-muted);">Verify file integrity with built-in MD5 checker</div>
                            </div>
                            <div>
                                <div style="font-weight:600;color:var(--text);margin-bottom:0.25rem;">‚≠ê Favorites</div>
                                <div style="font-size:0.875rem;color:var(--text-muted);">Bookmark your favorite games for quick access</div>
                            </div>
                        </div>
                    </div>

                    <!-- API Keys Setup -->
                    <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1.5rem;">
                        <h2 style="font-size:1.35rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem;">üîë Required API Keys</h2>
                        <div style="display:grid;gap:1rem;">
                            <div style="background:var(--bg-surface);padding:1rem;border-radius:8px;">
                                <div style="font-weight:600;color:var(--text);margin-bottom:0.5rem;">Real-Debrid API Key <span style="color:var(--red);font-size:0.75rem;">(Required)</span></div>
                                <div style="font-size:0.875rem;color:var(--text-muted);margin-bottom:0.5rem;">Enables downloading games via Real-Debrid service</div>
                                <a href="https://real-debrid.com/apitoken" target="_blank" style="color:var(--accent-bright);text-decoration:none;font-size:0.875rem;">‚Üí Get your API key at real-debrid.com/apitoken</a>
                            </div>
                            <div style="background:var(--bg-surface);padding:1rem;border-radius:8px;">
                                <div style="font-weight:600;color:var(--text);margin-bottom:0.5rem;">RAWG API Key <span style="color:var(--text-dim);font-size:0.75rem;">(Optional)</span></div>
                                <div style="font-size:0.875rem;color:var(--text-muted);margin-bottom:0.5rem;">Fetches game images and metadata for better browsing</div>
                                <a href="https://rawg.io/apidocs" target="_blank" style="color:var(--accent-bright);text-decoration:none;font-size:0.875rem;">‚Üí Get a free key at rawg.io/apidocs</a>
                            </div>
                        </div>
                        <button onclick="showSettingsModal()" style="margin-top:1rem;padding:0.75rem 1.5rem;background:var(--accent);color:white;border:none;border-radius:8px;font-weight:600;cursor:pointer;font-size:0.875rem;">Configure API Keys</button>
                    </div>

                    <!-- Tips & Tricks -->
                    <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1.5rem;">
                        <h2 style="font-size:1.35rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem;">üí° Tips & Keyboard Shortcuts</h2>
                        <div style="display:grid;gap:0.5rem;font-size:0.875rem;">
                            <div style="display:flex;justify-content:space-between;padding:0.5rem;background:var(--bg-surface);border-radius:6px;">
                                <span style="color:var(--text-muted);">Search games</span>
                                <kbd style="background:var(--bg-deep);padding:0.25rem 0.5rem;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:0.75rem;">/</kbd>
                            </div>
                            <div style="display:flex;justify-content:space-between;padding:0.5rem;background:var(--bg-surface);border-radius:6px;">
                                <span style="color:var(--text-muted);">Toggle favorites view</span>
                                <kbd style="background:var(--bg-deep);padding:0.25rem 0.5rem;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:0.75rem;">F</kbd>
                            </div>
                            <div style="display:flex;justify-content:space-between;padding:0.5rem;background:var(--bg-surface);border-radius:6px;">
                                <span style="color:var(--text-muted);">Random game</span>
                                <kbd style="background:var(--bg-deep);padding:0.25rem 0.5rem;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:0.75rem;">R</kbd>
                            </div>
                            <div style="display:flex;justify-content:space-between;padding:0.5rem;background:var(--bg-surface);border-radius:6px;">
                                <span style="color:var(--text-muted);">Switch to Library</span>
                                <kbd style="background:var(--bg-deep);padding:0.25rem 0.5rem;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:0.75rem;">1</kbd>
                            </div>
                            <div style="display:flex;justify-content:space-between;padding:0.5rem;background:var(--bg-surface);border-radius:6px;">
                                <span style="color:var(--text-muted);">Switch to Downloads</span>
                                <kbd style="background:var(--bg-deep);padding:0.25rem 0.5rem;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:0.75rem;">2</kbd>
                            </div>
                        </div>
                    </div>

                    <!-- Sources Info -->
                    <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1.5rem;">
                        <h2 style="font-size:1.35rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem;">üìö About Sources</h2>
                        <div style="display:grid;gap:1rem;">
                            <div style="display:flex;gap:1rem;align-items:start;">
                                <span class="source-badge fitgirl" style="position:static;margin-top:0.25rem;">FitGirl</span>
                                <div>
                                    <div style="font-weight:600;color:var(--text);margin-bottom:0.25rem;">FitGirl Repacks</div>
                                    <div style="font-size:0.875rem;color:var(--text-muted);">Highly compressed game repacks with magnet links. Known for excellent compression and quality.</div>
                                </div>
                            </div>
                            <div style="display:flex;gap:1rem;align-items:start;">
                                <span class="source-badge steamrip" style="position:static;margin-top:0.25rem;">SteamRIP</span>
                                <div>
                                    <div style="font-weight:600;color:var(--text);margin-bottom:0.25rem;">SteamRIP</div>
                                    <div style="font-size:0.875rem;color:var(--text-muted);">Direct download links from file hosters. Only games with Real-Debrid supported hosters are shown.</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Get Started -->
                    <div style="text-align:center;margin-top:1rem;">
                        <button onclick="showView('games')" style="padding:1rem 2rem;background:var(--accent);color:white;border:none;border-radius:10px;font-weight:700;cursor:pointer;font-size:1rem;">Browse Game Library ‚Üí</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="gamesView">
            <div class="filter-bar">
                <input type="text" id="searchInput" placeholder="Search games...  (press /)" class="filter-input" onkeyup="handleSearchChange()">
                <select id="genreSelect" class="filter-select" onchange="currentPage=1;currentGames=[];loadGames()"><option value="">All Genres</option></select>
                <select id="sortSelect" class="filter-select" onchange="currentPage=1;currentGames=[];loadGames()">
                    <option value="">Newest First</option><option value="date_asc">Oldest First</option>
                    <option value="title_asc">Title (A-Z)</option><option value="title_desc">Title (Z-A)</option>
                    <option value="size_desc">Size (Largest)</option><option value="size_asc">Size (Smallest)</option>
                </select>
                <div class="filter-spacer"></div>
                <div class="view-toggle">
                    <button id="viewList" onclick="setViewMode('list')" class="view-toggle-btn active">‚ò∞ List</button>
                    <button id="viewCard" onclick="setViewMode('card')" class="view-toggle-btn">‚ñ¶ Cards</button>
                </div>
                <button onclick="randomGame()" class="pill-btn" title="Random game">Random</button>
                <button id="favToggle" onclick="toggleFavoritesView()" class="pill-btn" title="Show favorites">Favorites</button>
                <button onclick="clearFilters()" class="pill-btn-clear" title="Clear filters">‚úï</button>
            </div>
            <p id="statsText" class="stats-text">Loading...</p>
            <div id="loadingIndicator" class="hidden loading-state"><div style="text-align:center"><div class="spinner" style="width:36px;height:36px;border-width:3px;margin-bottom:0.75rem;"></div><p style="color:var(--text-dim);font-size:0.85rem;">Loading games...</p></div></div>
            <div id="emptyState" class="hidden empty-state">
                <div class="empty-icon">üéÆ</div>
                <h3 class="empty-title">No games found</h3>
                <p class="empty-subtitle">We couldn't find any games matching your filters. Try adjusting your search or clear all filters to browse the full library.</p>
                <div class="empty-action">
                    <button onclick="clearFilters()" class="btn btn-primary">Clear Filters</button>
                </div>
            </div>
            <div id="gamesGrid" class="game-grid"></div>
            <div id="scrollSentinel" style="height:1px"></div>
            <div id="pagination"></div>
        </div>

        <div id="libraryView" class="hidden">
            <div class="library-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;">
                <h2 style="font-size:1.75rem;font-weight:700;">My Library</h2>
                <div class="library-tabs" style="display:flex;gap:0.5rem;background:var(--bg-surface);border-radius:10px;padding:0.25rem;">
                    <button id="tabFavorites" onclick="switchLibraryTab('favorites')" class="library-tab active" style="padding:0.5rem 1rem;border-radius:8px;background:transparent;border:none;color:var(--text-muted);font-family:inherit;font-size:0.825rem;font-weight:600;cursor:pointer;transition:all 0.2s;">‚≠ê Favorites</button>
                    <button id="tabDownloaded" onclick="switchLibraryTab('downloaded')" class="library-tab" style="padding:0.5rem 1rem;border-radius:8px;background:transparent;border:none;color:var(--text-muted);font-family:inherit;font-size:0.825rem;font-weight:600;cursor:pointer;transition:all 0.2s;">üì• Downloaded</button>
                </div>
            </div>
            <div id="libraryFavoritesTab">
                <div id="favoritesGrid" class="game-grid"></div>
                <div id="favoritesEmpty" class="empty-state hidden">
                    <div class="empty-icon">‚≠ê</div>
                    <h3 class="empty-title">No favorites yet</h3>
                    <p class="empty-subtitle">Games you favorite will appear here for easy access.</p>
                    <div class="empty-action">
                        <button onclick="showView('games')" class="btn btn-primary">Browse Games</button>
                    </div>
                </div>
            </div>
            <div id="libraryDownloadedTab" class="hidden">
                <div id="downloadedGrid" class="game-grid"></div>
                <div id="downloadedEmpty" class="empty-state hidden">
                    <div class="empty-icon">üì•</div>
                    <h3 class="empty-title">No downloaded games</h3>
                    <p class="empty-subtitle">Games you've downloaded will appear here.</p>
                    <div class="empty-action">
                        <button onclick="showView('downloads')" class="btn btn-primary">View Downloads</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="downloadsView" class="hidden">
            <div class="downloads-header">
                <div>
                    <h2>Download Queue</h2>
                    <p>Downloads are processed one at a time. Archives are auto-extracted when complete.</p>
                </div>
                <button onclick="scanExistingGames()" class="btn btn-ghost" style="white-space:nowrap">
                    üîç Scan Existing Games
                </button>
            </div>
            <div id="downloadsList">
                <div class="empty-state">
                    <div class="empty-icon">üì•</div>
                    <h3 class="empty-title">No downloads yet</h3>
                    <p class="empty-subtitle">Your download queue is empty. Browse the game library and click the Download button to start downloading games.</p>
                    <div class="empty-action">
                        <button onclick="showView('games')" class="btn btn-primary">Browse Games</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="clientsView" class="hidden">
            <div class="downloads-header">
                <div>
                    <h2>My Clients</h2>
                    <p>Link your Windows client to your account to receive downloads.</p>
                </div>
                <button onclick="loadClients()" class="btn btn-ghost" style="white-space:nowrap">
                    üîÑ Refresh
                </button>
            </div>

            <!-- Linked Clients -->
            <div style="margin-bottom:2rem;">
                <h3 style="font-size:1.1rem;font-weight:600;margin-bottom:0.75rem;color:var(--text);">‚úÖ Linked Clients</h3>
                <div id="linkedClientsList">
                    <div class="loading-state">
                        <div style="text-align:center">
                            <div class="spinner" style="width:24px;height:24px;border-width:2px;margin-bottom:0.5rem;"></div>
                            <p style="color:var(--text-dim);font-size:0.85rem;">Loading clients...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Unlinked Clients -->
            <div>
                <h3 style="font-size:1.1rem;font-weight:600;margin-bottom:0.75rem;color:var(--text);">üîó Available Clients</h3>
                <p style="font-size:0.85rem;color:var(--text-dim);margin-bottom:0.75rem;">These clients are not linked to any account. Click "Link to My Account" to connect your client.</p>
                <div id="unlinkedClientsList">
                    <div class="loading-state">
                        <div style="text-align:center">
                            <div class="spinner" style="width:24px;height:24px;border-width:2px;margin-bottom:0.5rem;"></div>
                            <p style="color:var(--text-dim);font-size:0.85rem;">Loading clients...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="uploadModal" class="hidden modal-overlay">
        <div class="modal-box sm">
            <h2 class="modal-title">Upload CSV</h2>
            <p class="form-help" style="margin-bottom:0.75rem;">Expected format: <code style="background:var(--bg-surface);padding:0.1rem 0.35rem;border-radius:4px;font-size:0.75rem;">Title,Size,magnet:?...</code></p>
            <input type="file" id="csvFile" accept=".csv" class="form-input" style="padding:0.4rem;">
            <div id="uploadError" class="hidden form-status" style="color:var(--red);"></div>
            <div class="modal-actions"><button id="uploadBtn" onclick="uploadCSV()" class="btn btn-primary">Upload</button><button onclick="hideUploadModal()" class="btn btn-secondary">Cancel</button></div>
        </div>
    </div>

    <div id="confirmModal" class="hidden modal-overlay">
        <div class="modal-box lg"><div id="confirmContent" style="color:var(--text-muted);"></div><div id="confirmBtnContainer" class="modal-actions"></div></div>
    </div>

    <div id="settingsModal" class="hidden modal-overlay">
        <div class="modal-box lg">
            <h2 class="modal-title">Settings</h2>

            <!-- Settings Tabs -->
            <div style="display:flex;gap:0.25rem;border-bottom:1px solid var(--border);margin-bottom:1.25rem;">
                <button class="settings-tab active" data-tab="general" onclick="switchSettingsTab('general')">General</button>
                <button class="settings-tab" data-tab="sources" onclick="switchSettingsTab('sources')">Sources</button>
                <button class="settings-tab" data-tab="realdebrid" onclick="switchSettingsTab('realdebrid')">Real-Debrid</button>
                <button class="settings-tab" data-tab="appearance" onclick="switchSettingsTab('appearance')">Appearance</button>
                <button class="settings-tab" data-tab="notifications" onclick="switchSettingsTab('notifications')">Notifications</button>
            </div>

            <!-- General Tab -->
            <div id="settingsTabGeneral" class="settings-panel">
                <div class="form-group">
                    <label class="form-label">Download Path <span class="hint">(optional)</span></label>
                    <p class="form-help">Default download directory for games. Leave blank for default.</p>
                    <input type="text" id="settingDownloadPath" placeholder="e.g. C:\Games" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">RAWG API Key <span class="hint">(for game images & metadata)</span></label>
                    <p class="form-help">Free at <a href="https://rawg.io/apidocs" target="_blank">rawg.io/apidocs</a></p>
                    <div class="form-row"><input type="password" id="settingRawgKey" placeholder="Enter RAWG API key..." class="form-input"><button onclick="toggleKeyVisibility('settingRawgKey')" class="btn btn-ghost" style="flex:0;padding:0.5rem 0.75rem;">üëÅ</button></div>
                    <p id="rawgKeyStatus" class="form-status"></p>
                </div>
            </div>

            <!-- Sources Tab -->
            <div id="settingsTabSources" class="settings-panel hidden">
                <div class="form-group">
                    <label class="form-label">Enabled Scrapers</label>
                    <p class="form-help">Choose which sources to scrape games from.</p>
                    <div class="checkbox-group" style="display:flex;flex-direction:column;gap:0.75rem;margin-top:0.5rem;">
                        <label style="display:flex;align-items:center;gap:0.5rem;cursor:pointer;">
                            <input type="checkbox" id="settingScraperFitgirl" checked style="width:18px;height:18px;cursor:pointer;">
                            <span style="font-weight:500;">FitGirl Repacks</span>
                        </label>
                        <label style="display:flex;align-items:center;gap:0.5rem;cursor:pointer;">
                            <input type="checkbox" id="settingScraperSteamrip" checked style="width:18px;height:18px;cursor:pointer;">
                            <span style="font-weight:500;">SteamRIP</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Real-Debrid Tab -->
            <div id="settingsTabRealdebrid" class="settings-panel hidden">
                <div class="form-group">
                    <label class="form-label">Real-Debrid API Key <span class="hint">(required for downloads)</span></label>
                    <p class="form-help">Get from <a href="https://real-debrid.com/apitoken" target="_blank">real-debrid.com/apitoken</a></p>
                    <div class="form-row"><input type="password" id="settingRdKey" placeholder="Enter Real-Debrid API key..." class="form-input"><button onclick="toggleKeyVisibility('settingRdKey')" class="btn btn-ghost" style="flex:0;padding:0.5rem 0.75rem;">üëÅ</button></div>
                    <p id="rdKeyStatus" class="form-status"></p>
                </div>
            </div>

            <!-- Appearance Tab -->
            <div id="settingsTabAppearance" class="settings-panel hidden">
                <div class="form-group">
                    <label class="form-label">Theme</label>
                    <select id="settingTheme" class="form-input">
                        <option value="dark">Dark (Default)</option>
                        <option value="light" disabled>Light (Coming Soon)</option>
                    </select>
                </div>
            </div>

            <!-- Notifications Tab -->
            <div id="settingsTabNotifications" class="settings-panel hidden">
                <div class="form-group">
                    <label class="form-label">Notification Preferences</label>
                    <p class="form-help">Choose which events trigger notifications.</p>
                    <div class="checkbox-group" style="display:flex;flex-direction:column;gap:0.75rem;margin-top:0.5rem;">
                        <label style="display:flex;align-items:center;gap:0.5rem;cursor:pointer;">
                            <input type="checkbox" id="settingNotifyDownloadComplete" checked style="width:18px;height:18px;cursor:pointer;">
                            <span style="font-weight:500;">Download completed</span>
                        </label>
                        <label style="display:flex;align-items:center;gap:0.5rem;cursor:pointer;">
                            <input type="checkbox" id="settingNotifyNewGames" style="width:18px;height:18px;cursor:pointer;">
                            <span style="font-weight:500;">New games available (after scrape)</span>
                        </label>
                        <label style="display:flex;align-items:center;gap:0.5rem;cursor:pointer;">
                            <input type="checkbox" id="settingNotifyErrors" checked style="width:18px;height:18px;cursor:pointer;">
                            <span style="font-weight:500;">Errors and failures</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Browser Notifications</label>
                    <button id="requestNotificationBtn" onclick="requestNotificationPermission()" class="btn btn-ghost" style="width:100%;">
                        Enable Browser Notifications
                    </button>
                    <p id="notificationStatus" class="form-status"></p>
                </div>
            </div>

            <div class="modal-actions"><button onclick="saveSettings()" class="btn btn-primary">Save</button><button onclick="hideSettingsModal()" class="btn btn-secondary">Cancel</button></div>
        </div>
    </div>

    <!-- Pre-Installation Check Modal -->
    <div id="preInstallModal" class="hidden modal-overlay">
        <div class="modal-box lg">
            <h2 class="modal-title">üìã Pre-Installation Check</h2>
            <div id="preInstallContent" style="margin:1rem 0;">
                <div style="text-align:center;padding:2rem;">
                    <div class="spinner" style="width:36px;height:36px;margin:0 auto 1rem;"></div>
                    <p style="color:var(--text-muted);">Checking system readiness...</p>
                </div>
            </div>
            <div class="modal-actions">
                <button onclick="hidePreInstallModal()" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>


    <!-- System Health View -->
    <div id="systemHealthView" class="hidden">
        <div style="display:grid;gap:1.5rem;">
            <!-- System Info Card -->
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1.5rem;">
                <h2 style="font-size:1.35rem;font-weight:700;margin-bottom:1rem;">üíª System Information</h2>
                <div id="systemInfoContent">
                    <div style="text-align:center;padding:2rem;">
                        <div class="spinner" style="width:36px;height:36px;margin:0 auto 1rem;"></div>
                        <p style="color:var(--text-muted);">Loading system info...</p>
                    </div>
                </div>
            </div>

            <!-- Installation Statistics -->
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1.5rem;">
                <h2 style="font-size:1.35rem;font-weight:700;margin-bottom:1rem;">üìä Installation Statistics</h2>
                <div id="installStatsContent">
                    <div style="text-align:center;padding:2rem;">
                        <div class="spinner" style="width:36px;height:36px;margin:0 auto 1rem;"></div>
                        <p style="color:var(--text-muted);">Loading statistics...</p>
                    </div>
                </div>
            </div>

            <!-- Recent Installation Logs -->
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1.5rem;">
                <h2 style="font-size:1.35rem;font-weight:700;margin-bottom:1rem;">üìú Recent Installation Logs</h2>
                <div id="installLogsContent">
                    <div style="text-align:center;padding:2rem;">
                        <div class="spinner" style="width:36px;height:36px;margin:0 auto 1rem;"></div>
                        <p style="color:var(--text-muted);">Loading logs...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Right Sidebar -->
    <aside id="rightSidebar" class="right-sidebar">
        <div class="sidebar-section">
            <h3 class="sidebar-title">Genres</h3>
            <input type="text" id="genreSidebarSearch" placeholder="Search genres..." class="sidebar-search" onkeyup="filterSidebarGenres()">
            <div id="genreFilterList" class="filter-list">
                <div style="text-align:center;padding:1rem;color:var(--text-dim);font-size:0.75rem;">Loading...</div>
            </div>
        </div>
        <div class="sidebar-section">
            <h3 class="sidebar-title">Tags</h3>
            <input type="text" id="tagSidebarSearch" placeholder="Search tags..." class="sidebar-search" onkeyup="filterSidebarTags()">
            <div id="tagFilterList" class="filter-list">
                <div style="text-align:center;padding:1rem;color:var(--text-dim);font-size:0.75rem;">Loading...</div>
            </div>
        </div>
    </aside>

    <!-- Sidebar Toggle Button -->
    <button id="sidebarToggle" class="sidebar-toggle" onclick="toggleSidebar()" title="Toggle filters">
        üîç
    </button>

    <div id="toast" class="hidden toast"><p id="toastMessage"></p></div>
    <script src="app.js"></script>
</body>
</html>
